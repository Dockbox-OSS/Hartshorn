install: gradle wrapper --gradle-version 6.3
language: java

os: linux
dist: trusty
jdk: oraclejdk8

after_success:
  - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
  - chmod +x send.sh
  - ./send.sh success $WEBHOOK_URL
after_failure:
  - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
  - chmod +x send.sh
  - ./send.sh failure $WEBHOOK_URL

jobs:
  include:
    - stage: 1_prepare_mcp
      name: "Prepare MCP workspace"
      script: gradle setupCiWorkspace -p ForgeMCP
    - stage: 2_build_core
      name: "Build Core"
      script: gradle build -p Core
    - stage: 3_build_sponge
      name: "Build Sponge implementation"
      script: gradle build -p Sponge
# Disabled until reworked
#    - stage: 4_build_modules
#      name: "Build internal modules"
#      script: gradle build -p Modules
